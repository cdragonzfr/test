Local

$time_filter$ (`get_notable_index` OR `get_sequenced_index`) host="hostnamevalue*" $source_filter$ 
| eval `get_event_id_meval`,rule_id=event_id 
| search $event_id_filter$ 
| fields - host_* 
| tags outputfield=tag 
| `mvappend_field(tag,orig_tag)` 
| dedup rule_id 
| `notable_xref_lookup` 
| `get_correlations` 
| search $security_domain_filter$ 
| `get_current_status` 
| search $status_filter$ 
| `get_owner` 
| search $owner_filter$ 
| `get_urgency` 
| search $urgency_filter$ 
| typer 
| tags outputfield=tag 
| `mvappend_field(tag,orig_tag)` 
| search $tag_filter$ 
| `suppression_extract` 
| search NOT suppression=* 
| `risk_correlation`
| `get_notable_type`
| `get_orig_source`
| `get_swimlane_record`
| eval xref_name="short_id" 
| lookup notable_xref_lookup event_id, xref_name OUTPUTNEW xref_id as short_id
| search $type_filter$


default

search = $time_filter$ (`get_notable_index` OR `get_sequenced_index`) $source_filter$ 
| eval `get_event_id_meval`,rule_id=event_id 
| search $event_id_filter$ 
| dedup rule_id 
| fields - host_* 
| tags outputfield=tag 
| `mvappend_field(tag,orig_tag)` 
| `notable_xref_lookup` 
| `get_correlations_performant` 
| search $security_domain_filter$ 
| `get_current_status` 
| search $status_filter$ 
| `get_owner` 
| search $owner_filter$ 
| `get_urgency` 
| search $urgency_filter$ 
| typer 
| tags outputfield=tag 
| `mvappend_field(tag,orig_tag)` 
| search $tag_filter$ 
| `suppression_extract` 
| search NOT suppression=* 
| `risk_correlation` 
| `get_mitre_annotations` 
| `get_notable_type` 
| `get_orig_source` 
| search $type_filter$ 
| search $disposition_filter$ 
| `add_normalized_risk_object`
